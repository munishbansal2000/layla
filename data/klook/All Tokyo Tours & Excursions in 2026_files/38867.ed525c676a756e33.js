"use strict";(("undefined"!=typeof window?window:this).webpackChunkorion_web_react=("undefined"!=typeof window?window:this).webpackChunkorion_web_react||[]).push([[38867],{215686:(e,t,r)=>{r.d(t,{O:()=>d});var i,o=r(364467),n=(r(898992),r(354520),r(672577),r(581454),r(696158)),a=r(654291),l=r(842709),s=r(8481);class d extends((0,n.x)()){}i=d,(0,o.A)(d,"fromDynamicFilterFragment",(e,t)=>{let{dynamicFilter:r,selectedDynamicFilters:o,destination:n,selected:a}=e;if(n&&r.localisedName){var l;const{metadata:e}=r,d=null==e||null===(l=e.find(e=>"icon"===e.key))||void 0===l?void 0:l.value;return new i({label:r.localisedName,reference:s.d.generateTagRef(r),url:s.d.fromFragments(r,o,n,t),selected:a,icon:null!=d?d:void 0,gqlData:r})}}),(0,o.A)(d,"fromGqlThingsToDoDynamicFiltersSelection",(e,t)=>{var r;if(null==e||!e.destination)return[];const o=(null===(r=e.thingsToDo)||void 0===r||null===(r=r.dynamicTagFilters)||void 0===r?void 0:r.filter(a.f))||[],n=(null==o?void 0:o.filter(e=>e.selected).map(e=>e.tag).filter(a.f))||[];return o.map(r=>{var o;let{tag:a,selected:s}=r;if((0,l.z)(a))return;const{metadata:d}=a,u=null==d||null===(o=d.find(e=>"icon"===e.key))||void 0===o?void 0:o.value;return i.fromDynamicFilterFragment({dynamicFilter:a,selectedDynamicFilters:n,destination:e.destination,selected:null!=s&&s,icon:null!=u?u:void 0},t)}).filter(a.f)})},256305:(e,t,r)=>{r.d(t,{t:()=>l});var i,o=r(364467),n=r(155688),a=r(348934);class l{}i=l,(0,o.A)(l,"fromFragmentsWithPrefix",(e,t,r,o)=>(0,n.F)(e,i.fromFragments(t,r,o))),(0,o.A)(l,"fromFragments",(e,t,r)=>(0,a.q)(e.canonicalName,e.id,t,r))},307037:(e,t,r)=>{r.d(t,{u:()=>a});var i=r(364467),o=r(696158),n=r(842709);class a extends((0,o.x)()){}(0,i.A)(a,"fromGqlDestinationFragment",e=>{var t,r,i;if(!(0,n.z)(e))return{bookingsLastSevenDays:null!==(t=e.bookingsLastSevenDays)&&void 0!==t?t:void 0,daysToBookingInAdvanceAvg:null!==(r=e.daysToBookingInAdvanceAvg)&&void 0!==r?r:void 0,isUserInDestination:null!==(i=e.isUserInDestination)&&void 0!==i?i:void 0}})},348934:(e,t,r)=>{if(r.d(t,{q:()=>o}),36674!=r.j)var i=r(361373);const o=(e,t,r,o)=>{return n=(0,i.H)(e),a=(0,i.H)(t),l=(0,i.H)(r),s=(0,i.H)(o),"/".concat(n,"/").concat(l,"/day-trips-d").concat(a,"-").concat(s);var n,a,l,s}},428232:(e,t)=>{Object.prototype.toString},445095:(e,t,r)=>{r.d(t,{v:()=>d});var i=r(364467),o=(r(18107),r(967357),r(898992),r(354520),r(581454),r(696158)),n=r(467115),a=r(654291),l=r(793282);const s=e=>e.map((e,t)=>{var r,i,o,n;return{listIndex:t,productCode:e.productCode,totalReviews:null===(r=e.rating)||void 0===r?void 0:r.reviewCount,avgRating:null===(i=e.rating)||void 0===i?void 0:i.exactRating,badgeType:null===(o=e.badges)||void 0===o?void 0:o.at(0),isPrivateTour:null!==(n=e.isPrivateTour)&&void 0!==n&&n,videoCount:e.videoCount,price:e.price.currentPrice.amount.toString(),currency:e.price.currentPrice.currencyCode,isNewProduct:e.isNewProduct,bookingsAllTime:e.bookingsAllTime}});class d extends((0,o.x)()){}(0,i.A)(d,"fromProductListWebModel",(0,n.CM)(e=>({pageNumber:e.currentPage,totalProducts:e.totalCount,products:s(e.products.map(l.q.fromProductShelfItemWebModel).filter(a.f))}))),(0,i.A)(d,"fromProductListViewModel",(0,n.CM)(e=>({pageNumber:e.currentPage,totalProducts:e.totalCount,products:s(e.products)})))},466963:(e,t,r)=>{r.d(t,{n:()=>l});var i,o=r(364467),n=r(696158),a=r(467115);class l extends((0,n.x)()){}i=l,(0,o.A)(l,"fromListingPageHeaderWebModel",(0,a.CM)(e=>new i({...e}))),(0,o.A)(l,"fromWebModelAndGqlOnPageFactors",(e,t)=>{var r;return new i({...e,title:null!==(r=null==t?void 0:t.h1)&&void 0!==r?r:e.title})})},526207:(e,t,r)=>{r.d(t,{I:()=>o});var i=r(296540);const o=()=>{const e=()=>{const r=new AbortController;return r.signal.onabort=()=>{t.current=e()},r},t=(0,i.useRef)(e());return t}},557248:(e,t,r)=>{r.d(t,{P:()=>i});const i=(0,r(408604).YK)({dayTripsLabel:{id:"orion.wordCloud.section.item.dayTrips",defaultMessage:"{0} to {1}"}})},572359:(e,t,r)=>{r.d(t,{f:()=>u});var i,o=r(364467),n=(r(898992),r(354520),r(581454),r(53574)),a=r(696158),l=r(467115),s=r(842709),d=r(654291);class u extends((0,a.x)()){}i=u,(0,o.A)(u,"fromWordCloudSectionWebModel",(0,l.CM)(e=>new i({title:e.title,url:e.url,trackingElementId:e.trackingElementId,items:e.links.map(e=>{let{url:t,label:r}=e;return{url:t,label:r}})}))),(0,o.A)(u,"fromGqlWorldCloudSection",(0,l.CM)(e=>{var t,r;if(!(0,s.z)(e))return new i({title:e.title,url:null!==(t=e.href)&&void 0!==t?t:void 0,items:e.items.map(n.N.fromWordcloudSectionItem).filter(d.f),trackingElementId:null!==(r=e.tracking)&&void 0!==r?r:void 0})}))},610468:(e,t,r)=>{r.d(t,{P:()=>a});var i=r(364467),o=r(696158),n=r(842709);class a extends((0,o.x)()){}(0,i.A)(a,"fromGqlDestinationFragment",e=>{var t,r,i;if(!(0,n.z)(e))return{id:e.id,name:e.name,canonicalName:e.canonicalName,cityName:null!==(t=e.cityName)&&void 0!==t?t:void 0,countryName:null!==(r=e.countryName)&&void 0!==r?r:void 0,parentName:null!==(i=e.parentName)&&void 0!==i?i:void 0}})},615033:(e,t,r)=>{r.d(t,{L:()=>i}),r(725440),r(898992),r(354520),r(581454);const i=e=>{const t=e.filter(e=>e.selected).map(e=>e.reference.replace("TAG-",""));return t.length>0?{primaryId:t[0],secondaryIds:t.slice(1)}:void 0}},621342:(e,t,r)=>{r.d(t,{w:()=>o});var i=r(364467);class o{}(0,i.A)(o,"fromFragment",e=>{var t;return null!=e&&null!==(t=e.legacyMapping)&&void 0!==t&&t.category?{categoryId:e.legacyMapping.category.id,groupId:e.legacyMapping.group.id}:null!=e&&e.legacyMapping?{groupId:e.legacyMapping.group.id}:e?{tagId:e.id}:{}})},639255:(e,t,r)=>{r.d(t,{W:()=>d});var i,o=r(364467),n=r(696158),a=r(467115),l=r(609673);const s={[l.GGp.Danger]:"attention",[l.GGp.Warning]:"warning"};class d extends((0,n.x)()){}i=d,(0,o.A)(d,"fromCampaignBanner",(0,a.CM)(e=>{let{theme:t,text:r}=e;return new i({colorVariant:s[t],text:r})}))},707054:(e,t,r)=>{if(r.d(t,{Ak:()=>l,Jp:()=>a,gS:()=>u,tF:()=>c}),r(517642),r(658004),r(733853),r(845876),r(432475),r(515024),r(731698),r(898992),r(354520),r(581454),r(908872),r(962953),36674!=r.j)var i=r(983127);if(36674!=r.j)var o=r(654291);var n=r(587235);const a=[n.jt.TIMES_OF_DAY,n.jt.DURATIONS,n.jt.PRICE,n.jt.RATINGS,n.jt.SPECIALS,n.jt.POPULAR_CATEGORIES,n.jt.OPERATORS,n.jt.LANGUAGES,n.jt.TOUR_SIZE,n.jt.WAYS_TO_EXPERIENCE,n.jt.ACCESSIBILITY].map(e=>e.toString()),l=e=>(0,o.f)(e)?e.values.options.filter(e=>e.selected).map(e=>e.value):[],s=e=>{if((0,o.f)(e)){const{selectedRange:t,validRange:r,unboundRange:i}=e.values,o=i?void 0:r[0],n=i?void 0:r[1];return{min:t[0]>r[0]?t[0]:o,max:t[1]<r[1]?t[1]:n}}return{min:void 0,max:void 0}},d={},u=function(e){let{hasCategoriesDropdownFiltersEligibility:t,hasCategoriesDropdownFiltersVariantA:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;const i=new Set(["sortType","dynamicFilters","currentPage","maxValidPrice","paxFilter","startDate","endDate","waysToExperience"]);return t&&r&&i.has("dynamicFilters")&&i.delete("dynamicFilters"),Object.keys(e).filter(e=>!i.has(e)).reduce((t,r)=>{const i=e[r];if(!(0,o.f)(i))return t;switch(r){case"maxPrice":return t+1;case"minPrice":return i>0?t+1:t;case"languageFilter":return t+i.appliedLanguages.length;default:return Array.isArray(i)?t+i.length:t+1}},0)},c=(e,t,r,o,d)=>{const u=o.filter(e=>a.includes(e.id)).reduce((e,t)=>(e[t.id]=t,e),{}),c=s(u[n.jt.PRICE]),g=s(u[n.jt.TOUR_SIZE]),v=(0,i.Q)(t.from)||void 0,p=(0,i.Q)(t.to)||void 0,m=l(u[n.jt.LANGUAGES]).length>0?{appliedLanguages:l(u[n.jt.LANGUAGES])}:void 0,f={sortType:e,startDate:v,endDate:p,minTourSizeFilter:g.min,maxTourSizeFilter:g.max,minPrice:c.min||0,maxPrice:c.max,dynamicFilters:r.filter(e=>e.selected).map(e=>e.reference),rating:l(u[n.jt.RATINGS]).pop(),timesOfDay:l(u[n.jt.TIMES_OF_DAY]),durations:l(u[n.jt.DURATIONS]),specials:l(u[n.jt.SPECIALS]),popularTags:l(u[n.jt.POPULAR_CATEGORIES]),operatorCodes:l(u[n.jt.OPERATORS]),waysToExperience:l(u[n.jt.WAYS_TO_EXPERIENCE]),accessibilityFilter:l(u[n.jt.ACCESSIBILITY]),languageFilter:m};return d&&(f.paxFilter=d),f}},768279:(e,t,r)=>{r.d(t,{q:()=>o}),r(898992),r(581454);var i=r(696158);class o extends((0,i.x)()){static fromWebModel(e){return new o({...e})}static fromWebModelList(e){return e.map(e=>o.fromWebModel(e))}static fromGqlFragment(e){return new o({question:e.question,answer:e.answer})}}},777448:(e,t,r)=>{r.d(t,{s:()=>g});var i,o=r(364467),n=(r(898992),r(354520),r(581454),r(955403)),a=r(365609),l=r(696158),s=r(467115),d=r(654291),u=r(587235),c=r(793282);class g extends((0,l.x)()){}i=g,(0,o.A)(g,"fromWebModel",(0,s.CM)(e=>({banners:e.banners,hasMachineTranslatedProducts:e.hasMachineTranslatedProducts,hasProductsTranslatedByGoogle:e.hasProductsTranslatedByGoogle,products:e.products.map(c.q.fromProductShelfItemWebModel).filter(d.f),sortType:e.sortType,currentPage:e.currentPage,pages:e.pages,totalCount:e.totalCount}))),(0,o.A)(g,"fromWebModelAndGqlProducts",(e,t,r)=>{var o,n,a,l,s,d;const{banners:c,showFirstProductAsSelected:g,highlightedProductCode:v,productFilterInput:p}=e;return{banners:c,hasMachineTranslatedProducts:null!==(o=null==t?void 0:t.hasMachineTranslatedProducts)&&void 0!==o&&o,hasProductsTranslatedByGoogle:null!==(n=null==t?void 0:t.hasProductsTranslatedByGoogle)&&void 0!==n&&n,products:i.buildProductListCardViewModels(t,r,g,v),sortType:null!==(a=null==p?void 0:p.sortType)&&void 0!==a?a:u.Jd.EXTERNAL,currentPage:null!==(l=null==p?void 0:p.currentPage)&&void 0!==l?l:1,pages:null!==(s=null==t?void 0:t.totalPageCount)&&void 0!==s?s:0,totalCount:null!==(d=null==t?void 0:t.totalProductCount)&&void 0!==d?d:0,showFirstProductAsSelected:g,highlightedProductCode:v}}),(0,o.A)(g,"fromViewModelAndGqlProducts",(e,t,r)=>{var o,n,a,l,s,d;return{banners:e.banners,hasMachineTranslatedProducts:null!==(o=null==t?void 0:t.hasMachineTranslatedProducts)&&void 0!==o&&o,hasProductsTranslatedByGoogle:null!==(n=null==t?void 0:t.hasProductsTranslatedByGoogle)&&void 0!==n&&n,products:i.buildProductListCardViewModels(t,r,e.showFirstProductAsSelected,e.highlightedProductCode),sortType:null!==(a=null==e?void 0:e.sortType)&&void 0!==a?a:u.Jd.EXTERNAL,currentPage:null!==(l=null==e?void 0:e.currentPage)&&void 0!==l?l:1,pages:null!==(s=null==t?void 0:t.totalPageCount)&&void 0!==s?s:0,totalCount:null!==(d=null==t?void 0:t.totalProductCount)&&void 0!==d?d:0,showFirstProductAsSelected:e.showFirstProductAsSelected,highlightedProductCode:e.highlightedProductCode}}),(0,o.A)(g,"buildProductListCardViewModels",(e,t,r,o)=>{var n,l;return null!==(n=null==e||null===(l=e.items.filter(d.f))||void 0===l?void 0:l.map(r=>i.buildProductWithDebug(r,e,t)).filter(d.f).map(e=>r&&o===e.productCode?{...e,badges:[a.L.SELECTED],isHighlighted:!0}:e))&&void 0!==n?n:[]}),(0,o.A)(g,"buildProductWithDebug",(e,t,r)=>c.q.fromProductCardFragment(e.product,r,n.I.fromGqlProductSearchItemAndGqlDebugInfo(e,t.sortDebugInfo)))},795086:(e,t,r)=>{r.d(t,{l:()=>v});var i=r(364467),o=(r(16280),r(296540));if(/^(39787|64041)$/.test(r.j))var n=r(603287);if(/^(39787|64041)$/.test(r.j))var a=r(537179);if(/^(39787|64041)$/.test(r.j))var l=r(7361);if(/^(39787|64041)$/.test(r.j))var s=r(654291);if(/^(39787|64041)$/.test(r.j))var d=r(842709);if(/^(39787|64041)$/.test(r.j))var u=r(609673);if(/^(39787|64041)$/.test(r.j))var c=r(80782);class g extends Error{constructor(e){super("Apollo aborted request"),(0,i.A)(this,"originalError",void 0),this.name="ApolloAbortError",this.originalError=e}}const v=e=>{const{destinationId:t,selectedTagIds:r,showGqlShelvesTtd:i,showGqlBlurbs:v,showGqlPeopleAlsoAsk:p,wordCloudProps:m,retrieveNoFollow:f,pageDisplayName:h,highlightedProductCode:y,showFirstProductAsSelected:A,retrieveDynamicFilters:P,retrieveOnPageFactor:T,skip:F=!1,retrieveMerchandisingDestinationMetrics:b,destinationTripId:C,attractionTripId:I,retrieveBookingsAllTime:w,retrieveAgeBandDiscounts:D,retrieveTopAttractions:S}=e,{hasDebugEnabled:E,userContext:x}=(0,a.w)(),j=(0,o.useRef)(new AbortController),R=(0,n.h)(),M=(0,c.Rq)(e),q=(0,c.t2)(t,null==r?void 0:r.primaryId,C,I),G=(0,c.mM)(t,null==r?void 0:r.primaryId),N=(0,c.Uk)(t,null==r?void 0:r.primaryId),L=m?(0,c.Ed)(t,m.groupId,m.categoryId,r,m.toAttractionId,m.toDestinationId):(0,c.Ed)(t,void 0,void 0,r),{data:W,refetch:k}=(0,u.Mm9)({variables:{input:M,pageBlurbInput:q,peopleAlsoAskInput:G,destinationId:M.destinationId,campaignBannerInput:N,showGqlShelvesTtd:i,showGqlBlurbs:v,showGqlPeopleAlsoAsk:p,gqlWordCloudInput:L,retrieveNoFollow:f,debugMode:E,onPageFactorsInput:(0,c.cQ)(R,h),retrieveDynamicFilters:P,retrieveOnPageFactor:T,retrieveWordCloud:(0,s.f)(L),retrieveBestSeller:(0,d.z)(y),affiliateLanderProductCode:null!=y?y:"",showAffiliateLanderProduct:(0,s.f)(y)&&!A,retrieveMerchandisingDestinationMetrics:b,retrieveBookingsAllTime:null!=w&&w,retrieveAgeBandDiscounts:null!=D&&D,userContextInput:x&&(0,c.Lv)(x),retrieveTopAttractions:null!=S&&S},context:{queryDeduplication:!1,fetchOptions:{signal:j.current.signal}},skip:F}),O=(0,o.useCallback)(t=>{let{productFilterRequest:r,pageNumber:i,retrieveOnPageFactor:o,reqDestinationId:n,newSelectedTags:a}=t;const s=((e,t,r,i,o)=>(0,c.Rq)({...e,destinationId:i,sortType:t.sortType,filterDefinitions:t.filterDefinitions,dateRange:t.dateRange,selectedTagIds:o,pageNumber:r,paxFilter:t.paxFilter}))(e,r,i,n,a);return j.current=new AbortController,k({retrieveOnPageFactor:o,destinationId:n.toString(),input:s}).catch(e=>"ApolloError"===e.name&&"Aborted"===(null==e?void 0:e.message)?Promise.reject(new g(e)):(console.error("Error during graphql request:",e),(0,l.a)(e),Promise.reject(e)))},[k]);return{data:W,refetchWithFilters:O,abortController:j.current}}},843460:(e,t,r)=>{r.d(t,{x:()=>m}),r(898992),r(672577),r(962953),r(548408),r(814603),r(147566),r(198721);var i=r(296540);if(36674!=r.j)var o=r(257536);if(36674!=r.j)var n=r(160340);if(36674!=r.j)var a=r(307776);if(36674!=r.j)var l=r(969965);if(36674!=r.j)var s=r(7361);if(36674!=r.j)var d=r(804015);if(36674!=r.j)var u=r(905926);if(36674!=r.j)var c=r(587235);if(36674!=r.j)var g=r(519914);if(36674!=r.j)var v=r(707054);if(36674!=r.j)var p=r(526207);const m=e=>{let{productListFilterAjaxURL:t,sortType:r,searchDates:m,dynamicFilters:f,productFilters:h,paxFilter:y,hasCategoriesDropdownFiltersEligibility:A,hasCategoriesDropdownFiltersVariantA:P,syntheticKeyword:T}=e;const{isMobileOrTablet:F}=(0,l.kW)(),[b,C]=(0,i.useState)(t),I=(0,i.useMemo)(()=>(0,g.W)(F,r,h),[F,r,h]),w={sortType:r,dateRange:m,dynamicFilters:f,filterDefinitions:I,paxFilter:y},[D,S]=(0,i.useState)(!1),[E,x]=(0,i.useState)(w);(0,i.useEffect)(()=>{x(w)},[F]);const j=(0,p.I)(),R=e=>{x(t=>({...t,...e}))},M=e=>{R({dynamicFilters:e})},q=e=>(0,v.tF)(e.sortType,e.dateRange,e.dynamicFilters,e.filterDefinitions,e.paxFilter),G=q(E),N=(0,v.gS)(G,{hasCategoriesDropdownFiltersEligibility:A,hasCategoriesDropdownFiltersVariantA:P}),L=N>0,W=e=>{const t={...E,...e},r={sortType:(e=>{const t=e.find(e=>e.id===c.jt.SORT_BY);if(!t||!("options"in t.values))return;const r=t.values.options.find(e=>e.selected);return r&&c.Jd[r.value]})(t.filterDefinitions)||t.sortType,dateRange:t.dateRange,dynamicFilters:t.dynamicFilters,filterDefinitions:t.filterDefinitions,paxFilter:t.paxFilter,shoreExcursionsData:t.shoreExcursionsData};return R(r),{request:r,ajaxWebRequest:q(r)}},k=(0,i.useCallback)((0,d.Q)((e,t,r)=>{var i;return null===(i=j.current)||void 0===i||i.abort(),S(!0),((e,t,r,i)=>{let n=e;if(i){const e=n.includes("?")?"&":"?",t=new URLSearchParams({[u.r.SYNTHETIC_KEYWORD]:i}).toString();n="".concat(n).concat(e).concat(t)}return o.A.post(n,t,{signal:null==r?void 0:r.signal}).then(e=>e.data)})(e,t,j.current,r).then(e=>(e&&M(e.dynamicFilters),S(!1),e)).catch(e=>{S(!1),"CanceledError"!==(null==e?void 0:e.name)&&(console.error("Error during filter request:",e),(0,s.a)(e))})},200),[]),O=(0,i.useCallback)((0,d.s)(e=>{var t;null===(t=j.current)||void 0===t||t.abort(),((e,t)=>{o.A.post(n.y2.TTD_FILTER_UPDATE_SESSION,e,{signal:null==t?void 0:t.signal})})(e,j.current)},200),[]);return{isLoadingProducts:D,sortType:E.sortType,filterDefinitions:E.filterDefinitions,dateRange:E.dateRange,dynamicFilters:E.dynamicFilters,paxFilter:E.paxFilter,hasAnyActiveFilter:L,activeFiltersCount:N,doFilterRequest:e=>{const{ajaxWebRequest:t}=W(e);let r=b;return e.shoreExcursionsData&&(r=(0,a.M7)(e.shoreExcursionsData),C(r)),k(r,t,T)},updateSession:e=>{const{request:t,ajaxWebRequest:r}=W(e);return O(r),t},updateDynamicFilters:M,updateFilterDefinitions:(e,t)=>{R({sortType:t,filterDefinitions:(0,g.W)(F,t,e)})},setIsLoadingProducts:S}}},905926:(e,t,r)=>{r.d(t,{r:()=>i});const i={SYNTHETIC_KEYWORD:"synthetic_keyword"}},924545:(e,t,r)=>{r.d(t,{s:()=>n});var i=r(364467),o=r(696158);class n extends((0,o.x)()){}(0,i.A)(n,"fromWebModel",e=>({viewName:e.viewName,domain:e.domain}))}}]);